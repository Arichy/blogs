# 2. Demo 场景简介与接口设计

在这个 Demo 里, 我们会模拟一个非常简单的购物系统, 包含三个服务:

1. storefront: 接收用户请求
2. pricing_engine: 计算价格, 会通过 http 请求 user_service, 返回用户等级, 计算对应的折扣 (这个名字是 ai 起的, 你可以简单理解为 pricing_service)
3. user_service: 用户服务, 存储用户信息, 包括用户等级

## storefront (port: 4040)

```
GET /price?user_id=number&product_id=number

根据 user_id 和 product_id, 返回 product 的 price
```

## pricing_engine (port: 50051)

```proto
service PricingService {
  rpc CalculatePrice(PriceRequest) returns (PriceResponse);
}

enum UserTier {
  BRONZE = 0;
  SILVER = 1;
  GOLD = 2;
}


message PriceRequest {
  uint64 user_id = 1;
  uint64 product_id = 2;
}

message PriceResponse {
  uint64 product_id = 1;
  double original_price = 2;
  double discounted_price = 3;
  UserTier user_tier = 4;
}
```

## user_service (port: 4041)

```
GET /users/{id}

根据 id 返回用户信息, 包含 user_tier
```
